/*! TiledGameEngine v0.0.1 - 10th Mar 2015 | https://github.com/elvariongh/tiledgameengine */
(function(d) {
var c=!0;function f(b,a,e,g){TiledGameEngine.Stage.call(this,"LoadingStage",b,a);this.am=this.am?this.am:new TiledGameEngine.Assets;this.b=g||1;this.c=1;this.a=0;this.g=void 0!==e?e:c;this.status={};this.e=this.e.bind(this);this.f=this.f.bind(this);this.d=c}f.prototype=Object.create(d.Stage.prototype);f.prototype.setStage=function(b){this.c=Math.max(b,this.b);console.log(this.c,b,this.b)};
f.prototype.request=function(b){if(Array.isArray(b))for(var a=b.length;a--;)this.am.request(b[a]),this.status[b[a]]=0;else this.am.request(b),this.status[b]=0};
f.prototype.start=function(){this.status.total=this.am.total();this.am.download(this.e,this.f);this.a=0;for(var b in this.status)"total"!==b&&(this.a+=this.status[b]);this.a=~~(this.a/this.status.total/this.b+(this.c-1)*(100/this.b));this.screen&&(this.screen.clear(),b=this.screen.getLayer(1),b.strokeStyle="rgba(255, 0, 0, 0.5)",b.fillStyle="rgba(255, 0, 0, 0.25)",b.lineWidth=1,b=this.screen.getLayer(2),b.textAlign="center",b.textBaseline="middle",b.fillStyle="rgba(255, 255, 255, 0.75)",this.d=this.redraw=
c,TiledGameEngine.bus.notify("invalidateStage",this.name))};f.prototype.onViewportResize=function(){TiledGameEngine.Stage.prototype.onViewportResize.call(this);var b=this.screen.getLayer(1);b.strokeStyle="rgba(255, 0, 0, 0.5)";b.fillStyle="rgba(255, 0, 0, 0.25)";b.lineWidth=1;b=this.screen.getLayer(2);b.textAlign="center";b.textBaseline="middle";b.fillStyle="rgba(255, 255, 255, 0.75)";this.d=this.redraw=c;TiledGameEngine.bus.notify("invalidateStage",this.name)};f.prototype.onViewportMove=function(){};
f.prototype.e=function(){this.a=~~(100*this.c/this.b);TiledGameEngine.bus.notify("assetsLoaded");this.redraw=c};f.prototype.f=function(b,a){this.a=0;for(var e in this.status)"total"!==e&&(e===b&&(this.status[e]=a),this.a+=this.status[e]);this.a=~~(this.a/this.status.total/this.b+(this.c-1)*(100/this.b));this.redraw=c};
f.prototype.activate=function(){TiledGameEngine.Stage.prototype.activate.call(this);this.i=1;3>this.screen.layers&&this.screen.addLayer(3-this.screen.layers);this.g&&this.start();this.d=c};f.prototype.update=function(){return 100>this.a?(this.redraw=c,500):1E3};
f.prototype.render=function(){this.j=!1;if(this.screen&&this.active){var b=this.screen.viewport,a;this.d&&(a=this.screen.getLayer(0),a.clearRect(0,0,b[2],b[3]),a.save(),a.translate(b[2]/2-93,b[3]/2-125),a.beginPath(),a.moveTo(0,0),a.lineTo(186.25,0),a.lineTo(186.25,250),a.lineTo(0,250),a.closePath(),a.clip(),a.scale(1.25,1.25),a.lineCap="butt",a.lineJoin="miter",a.miterLimit=4,a.save(),a.restore(),a.save(),a.translate(0,200),a.scale(0.1,-0.1),a.save(),a.fillStyle="rgba(29, 57, 101, 1)",a.strokeStyle=
"rgba(29, 57, 101, .75)",a.beginPath(),a.moveTo(1089,1909),a.bezierCurveTo(1070,1882,1062,1879,1030,1882),a.lineTo(992,1885),a.lineTo(981,1835),a.bezierCurveTo(975,1808,968,1776,965,1765),a.bezierCurveTo(960,1748,967,1740,1011,1721),a.bezierCurveTo(1077,1691,1135,1633,1166,1567),a.bezierCurveTo(1201,1490,1199,1473,1148,1459),a.bezierCurveTo(1038,1430,872,1453,745,1517),a.bezierCurveTo(715,1532,675,1543,647,1543),a.lineTo(598,1545),a.lineTo(662,1485),a.bezierCurveTo(738,1413,841,1357,946,1330),a.bezierCurveTo(1076,
1297,1320,1309,1340,1350),a.bezierCurveTo(1344,1358,1352,1378,1356,1394),a.bezierCurveTo(1363,1417,1373,1426,1400,1433),a.bezierCurveTo(1419,1438,1439,1445,1444,1450),a.bezierCurveTo(1449,1455,1447,1488,1440,1527),a.bezierCurveTo(1421,1638,1424,1633,1376,1627),a.bezierCurveTo(1353,1624,1330,1624,1324,1628),a.bezierCurveTo(1312,1636,1230,1756,1230,1765),a.bezierCurveTo(1230,1769,1239,1785,1251,1801),a.bezierCurveTo(1262,1817,1269,1837,1266,1845),a.bezierCurveTo(1260,1862,1142,1940,1123,1940),a.bezierCurveTo(1117,
1940,1101,1926,1089,1909),a.closePath(),a.fill(),a.stroke(),a.restore(),a.save(),a.fillStyle="rgba(236, 143, 41, 1)",a.strokeStyle="rgba(236, 143, 41, 0.75)",a.beginPath(),a.moveTo(197,1677),a.bezierCurveTo(165,1649,140,1618,140,1610),a.bezierCurveTo(140,1602,149,1584,160,1570),a.bezierCurveTo(186,1537,185,1530,151,1462),a.bezierCurveTo(115,1390,99,1376,63,1384),a.bezierCurveTo(48,1387,30,1387,24,1382),a.bezierCurveTo(8,1372,-2,1216,12,1202),a.bezierCurveTo(19,1195,39,1190,57,1190),a.bezierCurveTo(94,
1190,98,1184,129,1092),a.bezierCurveTo(152,1024,148,1E3,110,980),a.bezierCurveTo(84,966,85,948,111,924),a.bezierCurveTo(131,906,132,906,143,925),a.bezierCurveTo(179,991,263,1029,333,1012),a.lineTo(373,1001),a.lineTo(337,1038),a.bezierCurveTo(282,1095,256,1161,256,1250),a.bezierCurveTo(255,1306,261,1337,277,1371),a.bezierCurveTo(300,1422,365,1500,385,1500),a.bezierCurveTo(403,1500,475,1419,498,1373),a.bezierCurveTo(542,1287,555,1222,554,1080),a.bezierCurveTo(553,996,547,917,537,871),a.bezierCurveTo(528,
830,522,795,524,792),a.bezierCurveTo(527,790,542,812,559,842),a.bezierCurveTo(641,983,670,1185,631,1340),a.bezierCurveTo(603,1452,542,1576,479,1644),a.lineTo(429,1699),a.lineTo(389,1685),a.bezierCurveTo(345,1669,327,1674,298,1709),a.bezierCurveTo(288,1721,275,1730,268,1730),a.bezierCurveTo(261,1730,229,1706,197,1677),a.closePath(),a.fill(),a.stroke(),a.restore(),a.save(),a.fillStyle="rgba(78, 126, 40, 1)",a.strokeStyle="rgba(78, 126, 40, 0.75)",a.beginPath(),a.moveTo(1142,1269),a.bezierCurveTo(881,
1225,661,1032,586,781),a.lineTo(570,726),a.lineTo(606,697),a.bezierCurveTo(640,668,641,666,635,615),a.lineTo(628,562),a.lineTo(711,535),a.bezierCurveTo(802,504,795,503,832,570),a.lineTo(850,601),a.lineTo(931,598),a.bezierCurveTo(1011,595,1014,594,1030,565),a.bezierCurveTo(1039,549,1054,534,1062,532),a.bezierCurveTo(1082,528,1220,597,1220,611),a.bezierCurveTo(1220,616,1213,635,1204,651),a.bezierCurveTo(1189,680,1190,683,1214,719),a.bezierCurveTo(1228,739,1255,771,1274,789),a.bezierCurveTo(1306,820,
1311,822,1341,811),a.bezierCurveTo(1358,805,1377,800,1382,800),a.bezierCurveTo(1391,800,1425,870,1418,874),a.bezierCurveTo(1416,875,1395,885,1371,895),a.bezierCurveTo(1319,918,1281,971,1273,1029),a.bezierCurveTo(1269,1058,1263,1070,1251,1070),a.bezierCurveTo(1223,1070,1214,1057,1202,1E3),a.bezierCurveTo(1170,858,1045,757,900,756),a.bezierCurveTo(864,756,818,762,797,769),a.bezierCurveTo(762,781,759,785,765,809),a.bezierCurveTo(777,858,827,955,867,1006),a.bezierCurveTo(944,1102,1087,1192,1247,1246),
a.bezierCurveTo(1290,1260,1327,1274,1329,1276),a.bezierCurveTo(1337,1283,1196,1278,1142,1269),a.closePath(),a.fill(),a.stroke(),a.restore(),a.fillStyle="rgba(29, 57, 101, 1)",a.strokeStyle="rgba(29, 57, 101, 0.75)",a.beginPath(),a.save(),a.rect(20,430,310,-90),a.rect(120,340,110,-240),a.fill(),a.stroke(),a.closePath(),a.restore(),a.save(),a.beginPath(),a.moveTo(580,407),a.bezierCurveTo(530,374,509,331,509,265),a.bezierCurveTo(509,200,532,146,573,116),a.bezierCurveTo(614,86,749,86,800,116),a.bezierCurveTo(835,
136,835,137,838,213),a.lineTo(841,290),a.lineTo(760,290),a.lineTo(680,290),a.lineTo(680,250),a.bezierCurveTo(680,211,681,210,715,210),a.bezierCurveTo(756,210,760,198,725,182),a.bezierCurveTo(688,165,663,167,640,190),a.bezierCurveTo(615,215,613,295,636,328),a.bezierCurveTo(654,354,696,357,721,334),a.bezierCurveTo(735,321,750,319,789,325),a.bezierCurveTo(851,333,854,348,806,396),a.bezierCurveTo(773,429,770,430,692,430),a.bezierCurveTo(627,430,607,426,580,407),a.closePath(),a.fill(),a.stroke(),a.restore(),
a.save(),a.beginPath(),a.moveTo(1050,265),a.lineTo(1050,100),a.lineTo(1190,100),a.lineTo(1330,100),a.lineTo(1330,140),a.lineTo(1330,180),a.lineTo(1240,180),a.bezierCurveTo(1151,180,1150,180,1150,205),a.bezierCurveTo(1150,230,1151,230,1230,230),a.lineTo(1310,230),a.lineTo(1310,270),a.lineTo(1310,310),a.lineTo(1230,310),a.bezierCurveTo(1157,310,1150,312,1150,330),a.bezierCurveTo(1150,348,1157,350,1235,350),a.lineTo(1320,350),a.lineTo(1320,390),a.lineTo(1320,430),a.lineTo(1185,430),a.lineTo(1050,430),
a.lineTo(1050,265),a.closePath(),a.fill(),a.stroke(),a.restore(),a.rect(360,100,100,90),a.rect(890,100,100,90),a.rect(1370,100,100,90),a.fill(),a.stroke(),a.restore(),a.restore(),a=this.screen.getLayer(1),a.clearRect(b[2]/2-90,b[3]/2+130,180,20,20),a.roundRect(b[2]/2-90,b[3]/2+130,180,20,20).stroke());a=this.screen.getLayer(2);a.clearRect(b[2]/2-90,b[3]/2+130,180,20,20);a.strokeStyle="rgba(255, 0, 0, 0.5)";a.fillStyle="rgba(255, 0, 0, 0.25)";a.lineWidth=1;a.roundRect(b[2]/2-90,b[3]/2+130,180*this.a/100,20,20).fill();
a.textAlign="center";a.textBaseline="middle";a.fillStyle="rgba(255, 255, 255, 0.75)";a.fillText(this.a+"% Loaded",b[2]/2,b[3]/2+140,140);this.d=!1}};d.LoadingStage=f;
})(TiledGameEngine);